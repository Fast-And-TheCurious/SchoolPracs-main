const data = {
  lessons: [
    {
      unit: "UNIT 1",
      title: "Introduction",
      description: "good description",
      unitLink: "lesson1.html",
      worksheet: "example.txt",
      unitDescription:
        "This unit covers a wide range of topics related to the course. You will gain a comprehensive understanding of the subject matter.",
      masteryPoints: "1,500",
      unitLessons: [
        {
          lessonTitle: "Course Overview",
          lessonLink: "lessonpage.html",
          unitPracticeTitle: "Lesson 1 Practice",
          unitPracticeLink: "practice1.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/Nko_X2CU10I?si=OSPZ39ZyLBD5OiNI",
        },
        {
          lessonTitle: "Getting Started",
          lessonLink: "lesson2.html",
          unitPracticeTitle: "Lesson 2 Practice",
          unitPracticeLink: "practice2.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/JdqL89ZZwFw?si=04Q_OL3gQWiZ5A6v",
        },
        {
          lessonTitle: "Importance of the Subject",
          lessonLink: "lesson3.html",
          unitPracticeTitle: "Lesson 3 Practice",
          unitPracticeLink: "practice3.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/Nko_X2CU10I?si=OSPZ39ZyLBD5OiNI",
        },
        {
          lessonTitle: "Course Objectives",
          lessonLink: "lesson4.html",
          unitPracticeTitle: "Lesson 4 Practice",
          unitPracticeLink: "practice4.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/JdqL89ZZwFw?si=04Q_OL3gQWiZ5A6v",
        },
      ],
    },
    {
      unit: "UNIT 2",
      title: "Cool Stuff",
      description: "good description",
      unitLink: "lesson1.html",
      worksheet: "example.txt",
      unitDescription:
        "This unit covers a wide range of topics related to the course. You will gain a comprehensive understanding of the subject matter.",
      masteryPoints: "1,140",
      unitLessons: [
        {
          lessonTitle: "Exploring Cool Concepts",
          lessonLink: "lesson1.html",
          unitPracticeTitle: "Lesson 1 Practice",
          unitPracticeLink: "practice1.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/Nko_X2CU10I?si=OSPZ39ZyLBD5OiNI",
        },
        {
          lessonTitle: "Advanced Cool Techniques",
          lessonLink: "lesson2.html",
          unitPracticeTitle: "Lesson 2 Practice",
          unitPracticeLink: "practice2.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/JdqL89ZZwFw?si=04Q_OL3gQWiZ5A6v",
        },
        {
          lessonTitle: "Real-life Applications",
          lessonLink: "lesson3.html",
          unitPracticeTitle: "Lesson 3 Practice",
          unitPracticeLink: "practice3.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/Nko_X2CU10I?si=OSPZ39ZyLBD5OiNI",
        },
        {
          lessonTitle: "Cool Case Studies",
          lessonLink: "lesson4.html",
          unitPracticeTitle: "Lesson 4 Practice",
          unitPracticeLink: "practice4.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/JdqL89ZZwFw?si=04Q_OL3gQWiZ5A6v",
        },
      ],
    },
    {
      unit: "UNIT 3",
      title: "Solving Equations & Inequalities",
      description: "good description",
      unitLink: "lesson1.html",
      worksheet: "example.txt",
      unitDescription:
        "This unit covers a wide range of topics related to the course. You will gain a comprehensive understanding of the subject matter.",
      masteryPoints: "2,100",
      unitLessons: [
        {
          lessonTitle: "Introduction to Equations",
          lessonLink: "lessonpage.html",
          unitPracticeTitle: "Lesson 1 Practice",
          unitPracticeLink: "practice1.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/Nko_X2CU10I?si=OSPZ39ZyLBD5OiNI",
        },
        {
          lessonTitle: "Solving Linear Equations",
          lessonLink: "lesson2.html",
          unitPracticeTitle: "Lesson 2 Practice",
          unitPracticeLink: "practice2.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/JdqL89ZZwFw?si=04Q_OL3gQWiZ5A6v",
        },
        {
          lessonTitle: "Inequalities and Their Solutions",
          lessonLink: "lesson3.html",
          unitPracticeTitle: "Lesson 3 Practice",
          unitPracticeLink: "practice3.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/Nko_X2CU10I?si=OSPZ39ZyLBD5OiNI",
        },
        {
          lessonTitle: "Equations in Real-life Problems",
          lessonLink: "lesson4.html",
          unitPracticeTitle: "Lesson 4 Practice",
          unitPracticeLink: "practice4.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/JdqL89ZZwFw?si=04Q_OL3gQWiZ5A6v",
        },
      ],
    },
    {
      unit: "UNIT 4",
      title: "Advanced Topics in Math",
      description: "good description",
      worksheet: "example.txt",
      unitDescription:
        "This unit covers a wide range of topics related to the course. You will gain a comprehensive understanding of the subject matter.",
      masteryPoints: "400",
      unitLessons: [
        {
          lessonTitle: "Complex Numbers",
          lessonLink: "lessonpage.html",
          unitPracticeTitle: "Lesson 1 Practice",
          unitPracticeLink: "practice1.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/Nko_X2CU10I?si=OSPZ39ZyLBD5OiNI",
        },
        {
          lessonTitle: "Trigonometry and Calculus",
          lessonLink: "lesson2.html",
          unitPracticeTitle: "Lesson 2 Practice",
          unitPracticeLink: "practice2.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/JdqL89ZZwFw?si=04Q_OL3gQWiZ5A6v",
        },
        {
          lessonTitle: "Vectors and Matrices",
          lessonLink: "lesson3.html",
          unitPracticeTitle: "Lesson 3 Practice",
          unitPracticeLink: "practice3.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/Nko_X2CU10I?si=OSPZ39ZyLBD5OiNI",
        },
        {
          lessonTitle: "Advanced Problem Solving",
          lessonLink: "lesson4.html",
          unitPracticeTitle: "Lesson 4 Practice",
          unitPracticeLink: "practice4.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/JdqL89ZZwFw?si=04Q_OL3gQWiZ5A6v",
        },
      ],
    },
    {
      unit: "UNIT 5",
      title: "Statistics and Data Analysis",
      unitDescription: "good description",
      worksheet: "example.txt",
      unitDescription:
        "This unit covers a wide range of topics related to the course. You will gain a comprehensive understanding of the subject matter.",
      masteryPoints: "1,100",
      unitLessons: [
        {
          lessonTitle: "Introduction to Statistics",
          lessonLink: "lessonpage.html",
          unitPracticeTitle: "Lesson 1 Practice",
          unitPracticeLink: "practice1.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/Nko_X2CU10I?si=OSPZ39ZyLBD5OiNI",
        },
        {
          lessonTitle: "Data Collection and Analysis",
          lessonLink: "lesson2.html",
          unitPracticeTitle: "Lesson 2 Practice",
          unitPracticeLink: "practice2.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/JdqL89ZZwFw?si=04Q_OL3gQWiZ5A6v",
        },
        {
          lessonTitle: "Probability and Distributions",
          lessonLink: "lesson3.html",
          unitPracticeTitle: "Lesson 3 Practice",
          unitPracticeLink: "practice3.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/Nko_X2CU10I?si=OSPZ39ZyLBD5OiNI",
        },
        {
          lessonTitle: "Statistical Inference",
          lessonLink: "lesson4.html",
          unitPracticeTitle: "Lesson 4 Practice",
          unitPracticeLink: "practice4.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/JdqL89ZZwFw?si=04Q_OL3gQWiZ5A6v",
        },
      ],
    },
    {
      unit: "UNIT 6",
      title: "Geometry and Geometric Figures",
      unitDescription: "good description",
      worksheet: "example.txt",
      unitDescription:
        "This unit covers a wide range of topics related to the course. You will gain a comprehensive understanding of the subject matter.",
      masteryPoints: "1,100",
      unitLessons: [
        {
          lessonTitle: "Basic Geometric Shapes",
          lessonLink: "lessonpage.html",
          unitPracticeTitle: "Lesson 1 Practice",
          unitPracticeLink: "practice1.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/Nko_X2CU10I?si=OSPZ39ZyLBD5OiNI",
        },
        {
          lessonTitle: "Euclidean Geometry",
          lessonLink: "lesson2.html",
          unitPracticeTitle: "Lesson 2 Practice",
          unitPracticeLink: "practice2.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/JdqL89ZZwFw?si=04Q_OL3gQWiZ5A6v",
        },
        {
          lessonTitle: "Geometry in the Real World",
          lessonLink: "lesson3.html",
          unitPracticeTitle: "Lesson 3 Practice",
          unitPracticeLink: "practice3.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/Nko_X2CU10I?si=OSPZ39ZyLBD5OiNI",
        },
        {
          lessonTitle: "Non-Euclidean Geometry",
          lessonLink: "lesson4.html",
          unitPracticeTitle: "Lesson 4 Practice",
          unitPracticeLink: "practice4.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/JdqL89ZZwFw?si=04Q_OL3gQWiZ5A6v",
        },
      ],
    },
    {
      unit: "UNIT 7",
      title: "Algebraic Structures and Abstract Algebra",
      unitDescription: "good description",
      worksheet: "example.txt",
      unitDescription:
        "This unit covers a wide range of topics related to the course. You will gain a comprehensive understanding of the subject matter.",
      masteryPoints: "1,100",
      unitLessons: [
        {
          lessonTitle: "Groups and Rings",
          lessonLink: "lessonpage.html",
          unitPracticeTitle: "Lesson 1 Practice",
          unitPracticeLink: "practice1.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/Nko_X2CU10I?si=OSPZ39ZyLBD5OiNI",
        },
        {
          lessonTitle: "Fields and Vector Spaces",
          lessonLink: "lesson2.html",
          unitPracticeTitle: "Lesson 2 Practice",
          unitPracticeLink: "practice2.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/JdqL89ZZwFw?si=04Q_OL3gQWiZ5A6v",
        },
        {
          lessonTitle: "Applications of Abstract Algebra",
          lessonLink: "lesson3.html",
          unitPracticeTitle: "Lesson 3 Practice",
          unitPracticeLink: "practice3.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/Nko_X2CU10I?si=OSPZ39ZyLBD5OiNI",
        },
        {
          lessonTitle: "Algebraic Structures in Cryptography",
          lessonLink: "lesson4.html",
          unitPracticeTitle: "Lesson 4 Practice",
          unitPracticeLink: "practice4.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/JdqL89ZZwFw?si=04Q_OL3gQWiZ5A6v",
        },
      ],
    },
    {
      unit: "UNIT 8",
      title: "Systems of Equations",
      unitDescription: "good description",
      worksheet: "example.txt",
      unitDescription:
        "This unit covers a wide range of topics related to the course. You will gain a comprehensive understanding of the subject matter.",
      masteryPoints: "1,100",
      unitLessons: [
        {
          lessonTitle: "Introduction to Systems of Equations",
          lessonLink: "lessonpage.html",
          unitPracticeTitle: "Lesson 1 Practice",
          unitPracticeLink: "practice1.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/Nko_X2CU10I?si=OSPZ39ZyLBD5OiNI",
        },
        {
          lessonTitle: "Solving Linear Systems",
          lessonLink: "lesson2.html",
          unitPracticeTitle: "Lesson 2 Practice",
          unitPracticeLink: "practice2.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/JdqL89ZZwFw?si=04Q_OL3gQWiZ5A6v",
        },
        {
          lessonTitle: "Non-Linear Systems and Applications",
          lessonLink: "lesson3.html",
          unitPracticeTitle: "Lesson 3 Practice",
          unitPracticeLink: "practice3.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/Nko_X2CU10I?si=OSPZ39ZyLBD5OiNI",
        },
        {
          lessonTitle: "Matrix Methods for Solving Systems",
          lessonLink: "lesson4.html",
          unitPracticeTitle: "Lesson 4 Practice",
          unitPracticeLink: "practice4.html",
          lessonDescriptions:
            "https://www.youtube.com/embed/JdqL89ZZwFw?si=04Q_OL3gQWiZ5A6v",
        },
      ],
    },     
  ],
};


function calculateTotalMasteryPoints(data) {
    const totalMasteryPoints = data.lessons.reduce((total, lesson) => {
      return total + parseFloat(lesson.masteryPoints.replace(/,/g, ""));
    }, 0);
  
    return totalMasteryPoints.toLocaleString();
  }
  
  const totalMasteryPoints = calculateTotalMasteryPoints(data);
  console.log(`Total Mastery Points: ${totalMasteryPoints}`);

  function calculateUniqueUnits(data) {
    const uniqueUnits = new Set();
  
    // Iterate through the lessons and add the unit name to the Set
    data.lessons.forEach((lesson) => {
      uniqueUnits.add(lesson.unit);
    });
      return uniqueUnits.size;
  }
  
  const uniqueUnitCount = calculateUniqueUnits(data);/*  */
  console.log(`Number of Unique Units: ${uniqueUnitCount}`);
  
  const unitInformation = {
    unitInfo: [{ title: "Title", uniqueUnitCount: uniqueUnitCount }],
  };
// Function to change title dynamically
function changeTitle(newTitle) {
    // Update the title in the data object
    data.lessons[0].title = newTitle;  
    // Update the rendered HTML to reflect the new title
    const updatedLessonSidebarHtml = lessonSidebarTemplate({
      unitInfo: data.lessons[0],
      showAllUnits: showAllUnits,
    });
  
    document.getElementById("lesson-sidebar").innerHTML =
      updatedLessonSidebarHtml;
  }
  let showAllUnits = true;
  // Get the Handlebars template for the lesson sidebar
const lessonSidebarTemplateSource = document.getElementById(
    "lesson-sidebar-template"
  ).innerHTML;
  
  // Compile the template with data
  const lessonSidebarTemplate = Handlebars.compile(lessonSidebarTemplateSource);
  
  // Render the template with data
  const updatedLessonSidebarHtml = lessonSidebarTemplate({
    unitInfo: data.lessons,
    showAllUnits: showAllUnits,
  });
  
  // Update the rendered HTML in the "lesson-sidebar" element
  document.getElementById("lesson-sidebar").innerHTML = updatedLessonSidebarHtml;
  
  // Render sidebar with combined data and insert it into the page
const lessonSidebarHtml = lessonSidebarTemplate({
    unitInfo: unitInformation.unitInfo,
    lessons: data.lessons,
    numUnits: uniqueUnitCount,
    showAllUnits: showAllUnits,
    totalMasteryPoints: totalMasteryPoints,
  });
  
  document.getElementById("lesson-sidebar").innerHTML = lessonSidebarHtml;
  
const titleData = {
    unit: "All Units: Total Mastery Points",
    title: totalMasteryPoints,
  };

  const titleTemplateSource = document.getElementById("title-template").innerHTML;
  const titleTemplate = Handlebars.compile(titleTemplateSource);
  
  
  const titleHtml = titleTemplate(titleData);
  document.getElementById("title-container").innerHTML = titleHtml;
  
  const unitDescriptionSource = document.getElementById(
    "unit-description-template"
  ).innerHTML;
  const unitDescriptionTemplate = Handlebars.compile(unitDescriptionSource);
  
  const lessonTemplate = Handlebars.compile(
    document.getElementById("lesson-template").innerHTML
  );
  
  const lessonHtml = lessonTemplate(data);
  document.getElementById("lesson-container").innerHTML = lessonHtml;
  

  function updateContent(unit) {
    if (unit === "Title" || unit === "All Units: Total Mastery Points") {
      showAllUnits = true;
  
      const titleData = {
        unit: "All Units: Total Mastery Points",
        title: totalMasteryPoints,
      };
  
      const titleHtml = titleTemplate(titleData);
      document.getElementById("title-container").innerHTML = titleHtml;
  
      const unitDescriptionHtml = unitDescriptionTemplate({
        unitDescription: "",
      });
      document.getElementById("lesson-container").innerHTML = unitDescriptionHtml;
    } else {
      showAllUnits = false;
  
      const selectedLesson = data.lessons.find(
        (lesson) => lesson.unit === unit
      );
  
      const titleData = {
        unit: selectedLesson.unit,
        title: selectedLesson.title,
        masteryPoints: "Mastery points: " + selectedLesson.masteryPoints,
      };
  
      const titleHtml = titleTemplate(titleData);
      document.getElementById("title-container").innerHTML = titleHtml;
  
      const titlesAndInfo = [
        {
          title: "Lesson 1",
          info: selectedLesson.unitLessons[0].lessonTitle,
        },
        {
          title: "Lesson 2",
          info: selectedLesson.unitLessons[1].lessonTitle,
        },
        {
          title: "Lesson 3",
          info: selectedLesson.unitLessons[2].lessonTitle,
        },
        {
          title: "Lesson 4",
          info: selectedLesson.unitLessons[3].lessonTitle,
        },
        {
          title: "Worksheets",
          info: "Practice what you have learned",
        },
      ];
  
      const boxesHtml = titlesAndInfo
        .map(
          (item) => `
        <div class="info-box"><a href="${item.info.lessonLink}">
          <h2>${item.title}</h2>
          <p>${item.info.lessonTitle}</p>
          </a>
        </div>
      `
        )
        .join("");
  
      const aboutHtml = `
        <div class="about-section">
          <h2>About</h2>
          <p>${selectedLesson.unitDescription}</p>
        </div>
      `;
  
      const lessonContainerHtml = `
        <div class="lesson-content">
          ${aboutHtml}
          <div class="boxes-container">
            ${boxesHtml}
          </div>
        </div>
      `;
  
      document.getElementById("lesson-container").innerHTML = lessonContainerHtml;
  
      const contentArea2 = document.getElementById("content_area2");
      if (contentArea2) {
        contentArea2.scrollIntoView({ behavior: "smooth" });
      }
    }
  }
  function attachEventListeners() {
    document.querySelectorAll(".sidebar_lessonBox").forEach((item) => {
      item.addEventListener("click", (event) => {
        const unit =
          event.currentTarget.querySelector(".sub_sub-heading").textContent;
        updateContent(unit);
      });
    });
  
    document.querySelector(".main_heading").addEventListener("click", () => {
      updateContent("All Units: Total Mastery Points");
    });
  }
  
  // Call this function after rendering the content
  attachEventListeners();
  
  document.querySelector(".main_heading").addEventListener("click", () => {
    updateContent("All Units: Total Mastery Points");
  });
  
  document.querySelectorAll(".sidebar_lessonBox").forEach((item) => {
    item.addEventListener("click", (event) => {
      const unit =
        event.currentTarget.querySelector(".sub_sub-heading").textContent;
      updateContent(unit);
    });
  });
  // Function to update the worksheet download button based on the selected unit
function updateWorksheetDownloadButton(unit) {
    // Find the lesson object corresponding to the selected unit
    const selectedLesson = lessonData.lessons.find((lesson) => lesson.unit === unit);
  
    const dt = document.getElementById("worksheetDownloadButton");
  
    if (selectedLesson && selectedLesson.worksheet) {
      // Set the href and download attributes based on the worksheet information
      dt.href = `/School_Website/pdfs/${selectedLesson.worksheet}`;
      dt.download = `${selectedLesson.worksheet}`;
      // Enable the download button
      dt.removeAttribute("disabled");
    } else {
      // Disable the download button if the worksheet is not found
      dt.setAttribute("disabled", "true");
    }
  }
  
  // Event listener for clicking on a unit in the sidebar
  document.querySelectorAll(".sidebar_lessonBox").forEach((item) => {
    item.addEventListener("click", (event) => {
      const unit = event.currentTarget.querySelector(".sub_sub-heading").textContent;
      updateContent(unit);
      updateWorksheetDownloadButton(unit); // Update the worksheet download button
    });
  });
  